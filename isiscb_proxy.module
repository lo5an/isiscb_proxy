<?php

function isiscb_proxy_menu() {

    $items['isiscb_proxy/json'] = array(
				       'access callback'   => true, // available to all
				       'page callback'     => 'isiscb_proxy_object', // defined below
				       );



    $items['admin/settings/isiscb_proxy'] = array(
						'title' => 'Isis CB Proxy Settings',
						'description' => 'Configure your ISISCB Proxy',
						'page callback' => 'drupal_get_form',
						'page arguments' => array('isiscb_proxy_form'),
						'access arguments' => array('administer isiscb_proxy settings'),
						'type' => MENU_NORMAL_ITEM,
						);
			   



    return $items;
}



function isiscb_proxy_form() {

    $form = array();

    $form['isiscb_proxy_id'] = array(
				     '#type' => 'textfield',
				     '#title' => t('Isis CB Client ID'),
				     '#default_value' => variable_get('onthisdate_maxdisp', ""),
				     '#description' => t("Client ID to use for retrieving data"),
				     '#required' => TRUE,
				     );

    $form['isiscb_proxy_pass'] = array(
				     '#type' => 'password',
				     '#title' => t('Isis CB Client Password'),
				     '#default_value' => variable_get('onthisdate_maxdisp', ""),
				     '#description' => t("Client password to use for retrieving data"),
				     '#required' => TRUE,
				     );
    
    return system_settings_form($form);
    
}




function isiscb_proxy_object() {
    $url="http://data.isiscb.org/rest/?format=json";

    /* check for cached data based on url */


    /* if cache miss, get from IsisCB */
    $response = drupal_http_request($url);
    $data = json_decode($response->data);



    return $data;
}